# Data-Model Specification – Release v1.0

This document defines the canonical schema for SwiftData entities used in the Books iOS app.

---

## 1. Entity: `BookMetadata`

| Field            | Type    | Optional | Default | Notes                                                 |
|------------------|---------|----------|---------|-------------------------------------------------------|
| `googleBooksID`  | String  | ❌       | –       | Primary identifier when fetched online; UUID when manual. |
| `title`          | String  | ❌       | –       | Trimmed, max 512 chars.                               |
| `authors`        | [String]| ❌       | –       | ≥ 1 author. Normalized "Last, First" not enforced yet.|
| `publishedDate`  | String  | ✅       | –       | Preferred ISO-8601 `yyyy-MM-dd`; may be year-only.    |
| `pageCount`      | Int     | ✅       | –       | Positive integer.                                     |
| `publisher`      | String  | ✅       | –       |                                                       |
| `isbn`           | String  | ✅       | –       | 10 or 13 digits, no dashes; validation deferred.      |
| `imageURL`       | URL     | ✅       | –       | Cover thumbnail.                                      |
| `bookDescription`| String  | ✅       | –       | Plain-text/Markdown; max 10k chars.                   |
| `language`       | String  | ✅       | –       | Primary language code (e.g., "en", "es").             |
| `previewLink`    | URL     | ✅       | –       | Google Books preview URL.                             |
| `infoLink`       | URL     | ✅       | –       | Google Books info page URL.                           |
| `genre`          | [String]| ✅       | –       | Categories/genres from Google Books API.               |
| `originalLanguage`| String | ✅       | –       | Original publication language if translated.           |
| `authorNationality`| String| ✅      | –       | Primary author's nationality.                         |
| `translator`     | String  | ✅       | –       | Translator name if applicable.                        |
| `format`         | Enum    | ✅       | –       | Physical, digital, audiobook format.                 |

### Relationships
• _Zero-or-many_ `UserBook` objects reference a single `BookMetadata`.
• Cascade delete: only remove `BookMetadata` when no `UserBook` points to it.

---

## 2. Entity: `UserBook`

### Core Fields
| Field            | Type   | Optional | Default            | Notes                                                         |
|------------------|--------|----------|--------------------|---------------------------------------------------------------|
| `id`             | UUID   | ❌       | Auto-generated     | Primary key.                                                  |
| `metadata`       | Link→BookMetadata | ✅ | –              | Many : 1 relationship (optional for initialization).          |
| `readingStatus`  | Enum   | ❌       | `toRead`           | `.toRead`, `.reading`, `.read`, `.onHold`, `.dnf`             |
| `onWishlist`     | Bool   | ❌       | `false`            | True → separate wishlist view.                                |
| `isFavorited`    | Bool   | ❌       | `false`            | User's favorite books.                                        |
| `owned`          | Bool   | ❌       | `true`             | Whether user physically owns the book.                        |
| `rating`         | Int    | ✅       | –                  | 1-5 inclusive.                                                |
| `notes`          | String | ✅       | –                  | Private; max 5k chars.                                       |
| `tags`           | [String]| ❌      | `[]`               | User-defined tags for organization.                           |
| `dateAdded`      | Date   | ❌       | `Date()`           | Set on insertion.                                             |
| `dateStarted`    | Date   | ✅       | –                  | Auto-set when status → `.reading` if nil.                     |
| `dateCompleted`  | Date   | ✅       | –                  | Auto-set when status → `.read`.                               |

### Enhanced Reading Progress Tracking
| Field                | Type   | Optional | Default | Notes                                                     |
|---------------------|--------|----------|---------|-----------------------------------------------------------|
| `currentPage`       | Int    | ❌       | `0`     | Current reading position; triggers progress calculation.   |
| `readingProgress`   | Double | ❌       | `0.0`   | 0.0 to 1.0 calculated from currentPage/totalPages.       |
| `estimatedFinishDate` | Date | ✅       | –       | Calculated from reading pace and daily goals.            |
| `totalReadingTimeMinutes` | Int | ❌   | `0`     | Cumulative reading time across all sessions.             |
| `dailyReadingGoal`  | Int    | ✅       | –       | Target pages per day.                                     |
| `personalRating`    | Double | ✅       | –       | 0.0 to 5.0 for more granular ratings.                    |

### Cultural Diversity Tracking
| Field                      | Type   | Optional | Default | Notes                                        |
|---------------------------|--------|----------|---------|----------------------------------------------|
| `contributesToCulturalGoal` | Bool   | ❌       | `false` | Whether book counts toward diversity goals.  |
| `culturalGoalCategory`     | String | ✅       | –       | e.g., "African Literature", "Translated Works" |

### Social and Sharing Features
| Field              | Type   | Optional | Default | Notes                                      |
|-------------------|--------|----------|---------|--------------------------------------------|
| `isPublic`        | Bool   | ❌       | `false` | Whether reading data is publicly visible. |
| `recommendedBy`   | String | ✅       | –       | Who recommended this book.                 |
| `wouldRecommend`  | Bool   | ✅       | –       | User's recommendation status.              |
| `discussionNotes` | String | ✅       | –       | Notes for book clubs or discussions.       |

### Complex Data (Stored as JSON Strings)
| Field               | Computed Type      | Storage Type | Notes                                    |
|--------------------|-------------------|--------------|------------------------------------------|
| `quotes`           | [String]?         | String       | Separated by "†††", max content varies. |
| `readingSessions`  | [ReadingSession]  | String       | JSON-encoded reading session data.      |

---

## 3. Supporting Types

### ReadingStatus Enum